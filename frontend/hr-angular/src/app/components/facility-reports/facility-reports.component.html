<div class="facility-reports">
    <h1>Facility Reports</h1>

    <!-- Loading and Error Messages -->
    <div *ngIf="loading$ | async" class="loading">Loading...</div>
    <div *ngIf="error$ | async as error" class="error">{{ error }}</div>

    <!-- Reports Table -->
    <table *ngIf="reports$ | async as reports" class="reports-table">
        <thead>
            <tr>
                <th>Title</th>
                <th>Description</th>
                <th>Status</th>
                <th>Created At</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let report of reports">
                <td>{{ report.title }}</td>
                <td>{{ report.description }}</td>
                <td>{{ report.status }}</td>
                <td>{{ report.created_at | date: 'short' }}</td>
                <td>
                    <button (click)="onViewComments(report)">View Comments</button>
                </td>
            </tr>
        </tbody>
    </table>

    <!-- Comments Section -->
    <div *ngIf="selectedReport" class="comments-section">
        <h2>Comments for: {{ selectedReport.title }}</h2>
        <ul>
            <li *ngFor="let comment of selectedReport.comments">
                <strong>{{ comment.updated_at | date: 'short' }}:</strong>
                {{ comment.description || 'No description provided' }}
            </li>
        </ul>

        <textarea
            #commentInput
            placeholder="Add a comment..."
            rows="3"
            style="width: 100%;"
        ></textarea>
        <button
            (click)="onAddComment(selectedReport._id, commentInput.value); commentInput.value=''"
        >
            Submit Comment
        </button>

        <button (click)="closeComments()">Close Comments</button>
    </div>
</div>
